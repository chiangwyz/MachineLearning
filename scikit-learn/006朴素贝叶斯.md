# 朴素贝叶斯

朴素贝叶斯(Naive Bayes)是常用于自然语言分类问题的算法，它在垃圾邮件过滤上的应用非常有名。

## 概述

朴素贝叶斯是一个基于概率进行预测的算法，实践中主要被用于分类问题，就是计算数据为某个标签的概率，并将其分类为概率值最大的标签。朴素贝叶斯主要用于文本分类和垃圾邮件判定等自然语言处理中的分类问题。

朴素贝叶斯基于文本中包含的单词推测未知数据的类别。

**条件概率**：

## 算法说明

虽然最终要做的是自然语言处理的分类，但是在应用朴素贝叶斯时，还需要将输入数据转换为由特征值构成的向量，先在预处理阶段将文本转换成由特征值构成的向量，然后使用朴素贝叶斯进行训练，最后查看结果。

### 预处理

在预处理阶段，将文本转换为BoW(Bag of Words，词袋)的形式，形成由特征值构成的向量和标签组合。

先从现有训练数据的文本中只提取名词，忽略名词在文本中的顺序，把他们作为集合处理。

接下来，将训练数据和类别转换为易于处理的数据形式，当所有的单词集合包含训练数据的单词时，将该单词的值设为1，否则设为0，另外，当类别为“电影”时，将类别的值替换为1；当类别为“宇宙”时，将类别的值替换为0，这些就是标签，如下表所示：

| 训练数据 | 名作 | 电影 | 华丽 | 动作 | 世界 | 感动 | 沙尘暴 | 火星 | 探测 | 重新开始 | VR | 类别 |
| ------ | ------ | ------ | ------ | ------ | ------ | ------ | ------ | ------ | ------ | ------ | ------ | ------ |
| 那部让人感动的电影名作重映 | 1 | 1 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | 1 |
| 华丽的动作电影 | 0 | 1 | 1 | 1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 1 |
| 复映的名作感动了世界 | 1 | 0 | 0 | 0 | 1 | 1 | 0 | 0 | 0 | 0 | 0 | 1 |
| 沙尘暴笼罩了世界 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 1 | 0 | 0 | 0 | 0 |
| 火星探测终于重新开始 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 1 | 1 | 1 | 0 | 0 |
| VR中看到的火星沙尘暴让人感动 | 0 | 0 | 0 | 0 | 0 | 1 | 1 | 1 | 0 | 0 | 1 | 0 |

通过以上处理，我们可以将以自然语言书写的文本转换为表示单词出现的特征向量和标签的组合，这种文本表示方式为BoW。下面，采用同样的做法处理验证数据，验证数据中包含了训练数据中不包含的“复映”一词，这样的单词很难处理，简单起见，这次就不处理这个词，文本处理的结果如下表：


| 训练数据 | 名作 | 电影 | 华丽 | 动作 | 世界 | 感动 | 沙尘暴 | 火星 | 探测 | 重新开始 | VR | 类别 |
| ------ | ------ | ------ | ------ | ------ | ------ | ------ | ------ | ------ | ------ | ------ | ------ | ------ |
| 复映的动作电影让人感动 | 1 | 1 | 0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 | 0 | ??? |

通过实施上述预处理，本次的问题就变成为预测验证数据$[1,1,0,0,0,1,0,0,0,0,0]$的类别的问题。

### 概率的计算

朴素贝叶斯使用训练数据来学习与各标签对应的单词的出现概率。在分类时求出每个标签对应的概率，将概率最高的标签作为分类结果，朴素贝叶斯在训练时计算以下两种概率：

1. 每个标签出现的概率；
2. 在各标签下，每个单词出现的条件概率。




对朴素贝叶斯在训练时进行的处理汇总，如下表：

#### 表 训练时进行的处理


| 类别\条件概率 | 名作 | 电影 | ... | 感动 | ... | VR |
| ------ | ------ | ------ | ------ | ------ | ------ | ------ | 
| 电影 | 2/3 | 2/3 | ... | 2/3 | ... | 0.01 |
| 宇宙 | 0.01 | 0.01 | ... | 1/3 | ... | 1/3 |

在上表中，应该出现概率为0的地方，我们分配了小的概率值为0.01，这种做法叫做平滑(Smoothing)，概率为0的位置表示在对应的训练数据中没有出现对应的单词，但是如果使用规模更大的数据集作为训练数据，该单词却有可能会出现，平滑处理考虑了这种可能性，在没有出现单词的位置也分配小的概率值。


在分类时，朴素贝叶斯分别为每个标签值计算上述两个概率的乘积，通过比较进行分类。

例如，对本次的验证数据$[1,1,0,0,0,1,0,0,0,0,0]$(复映的动作电影让人感动)这个文本进行分类时，实际比较的是下列处理的结果。

1. 求出“电影”类别文本出现的概率；
2. 从“电影”类别的文本中分别求出“名作”“动作”“感动”这几个单词出现的概率。
3. 对于文本中没有出现的单词，也要求出在“电影”类别的文本中没有出现的概率。
4. 计算所有概率的乘积。

按照标签比较验证文本的处理结果，输出其中概率最大的标签作为分类结果。

朴素贝叶斯分别计算了作为特征值的每个单词的概率，没有考虑单词的顺序和组合，朴素贝叶斯通过“每个单词都是独立的”这个一个简单的假设简化了学习过程。


